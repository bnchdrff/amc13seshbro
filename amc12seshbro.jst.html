<script type="text/x-dot-template" id="seshbro-tpl-seshbro">
  <div id="categories"></div><div id="seshes"></div>
</script>
<script type="text/x-dot-template" id="seshbro-tpl-categories">
  {{##def.checkbox:
    <li>
      <input type="checkbox" value="{{=the.get("tid")}}" id="term-{{=the.get("tid")}}" />
      <label for="term-{{=the.get("tid")}}">
        {{=the.get("name")}}{{? the.get("imgurl") }}<span class="track-icon" style="background-image:url(/{{=Drupal.settings.pathToFiles}}{{=the.get("imgurl")}});">&nbsp;</span>{{?}}
      </label>
    </li>
  #}}
  {{##def.blockcheckbox:
    <li data-parent-tid="{{=the.get("parents")[0]}}">
      <input type="checkbox" value="{{=the.get("tid")}}" id="term-{{=the.get("tid")}}" />
      <label for="term-{{=the.get("tid")}}">
        {{=the.get("name")}}
      </label>
    </li>
  #}}
  {{##def.controls:
    <div class="controls">
      Filter by
      <a href="#" id="select-none">View all sessions</a>
    </div>
  #}}
  {{##def.categories:
  <div class="categories t_ps_ng">
    <a href="#" class="expandocat">Content</a>
    <div class="category t">
      <h3>Tracks</h3>
      <ul>
        {{ for (var tid in it.t_ps_ng.t) { }}
          {{ var the = it.t_ps_ng.t[tid]; }}
          {{#def.checkbox}}
        {{ } }}
      </ul>
    </div>
    <div class="category ps">
      <h3>Practice Spaces</h3>
      <ul>
        {{ for (var tid in it.t_ps_ng.ps) { }}
          {{ var the = it.t_ps_ng.ps[tid]; }}
          {{#def.checkbox}}
        {{ } }}
      </ul>
    </div>
    <div class="category ng">
      <h3>Network Gatherings</h3>
      <ul>
        {{ for (var tid in it.t_ps_ng.ng) { }}
          {{ var the = it.t_ps_ng.ng[tid]; }}
          {{#def.checkbox}}
        {{ } }}
      </ul>
    </div>
    <div class="clear-both">&nbsp;</div>
  </div>
  <div class="categories locations">
    <a href="#" class="expandocat">Place</a>
    <div class="category location">
      <ul>
        {{ for (var tid in it.locations) { }}
          {{ var the = it.locations[tid]; }}
          {{#def.checkbox}}
        {{ } }}
      </ul>
    </div>
    <div class="clear-both">&nbsp;</div>
  </div>
  <div class="categories daytime">
    <a href="#" class="expandocat">Day/Time</a>
    <div class="category thursday">
      <h3>Ongoing</h3>
      <ul>
        {{ for (var tid in it.blocks.ongoing) { }}
          {{ var the = it.blocks.ongoing[tid]; }}
          {{#def.blockcheckbox}}
        {{ } }}
      </ul>
      <h3>Thursday</h3>
      <ul>
        {{ for (var tid in it.blocks.thursday) { }}
          {{ var the = it.blocks.thursday[tid]; }}
          {{#def.blockcheckbox}}
        {{ } }}
      </ul>
    </div>
    <div class="category friday">
      <h3>Friday</h3>
      <ul>
        {{ for (var tid in it.blocks.friday) { }}
          {{ var the = it.blocks.friday[tid]; }}
          {{#def.blockcheckbox}}
        {{ } }}
      </ul>
    </div>
    <div class="category saturday">
      <h3>Saturday</h3>
      <ul>
        {{ for (var tid in it.blocks.saturday) { }}
          {{ var the = it.blocks.saturday[tid]; }}
          {{#def.blockcheckbox}}
        {{ } }}
      </ul>
    </div>
    <div class="category sunday">
      <h3>Sunday</h3>
      <ul>
        {{ for (var tid in it.blocks.sunday) { }}
          {{ var the = it.blocks.sunday[tid]; }}
          {{#def.blockcheckbox}}
        {{ } }}
      </ul>
    </div>
    <div class="clear-both">&nbsp;</div>
  </div>
  #}}
  {{#def.controls}}
  {{#def.categories}}
</script>
<script type="text/x-dot-template" id="seshbro-tpl-seshes">
  <ul class="seshes">
    {{ for (var i = -1, l = it.seshes.length; ++i < l;) { var sesh = it.seshes[i]; }}
      <li class="session"{{
        var seshtime = app.seshbro.categoriesView.collection.get( sesh.field_2012sched[0].value );
        }}{{? seshtime && seshtime.get("parents") }} data-day="{{=seshtime.get("parents")[0]}}" data-time="{{=seshtime.get("name")}}"{{?}}>
        <div class="left">
          <a href="http://talk.alliedmedia.org/{{=sesh.path}}" class="expandosesh"><h4>{{=sesh.title}}</h4></a>
<div class="track-gutter">
{{
for (tid in sesh.taxonomy ) {
  var url = app.seshbro.categoriesView.collection.get(tid).get('imgurl');
}}
{{? url }}
    <div style="background-image:url(/{{=Drupal.settings.pathToFiles}}{{=url}});" title="{{=app.seshbro.categoriesView.collection.get(tid).get('name')}}">&nbsp;</div>
{{?}}
{{
}
}}
</div>
          {{? sesh.field_2012tweetable[0] }}
            <p class="tweetable">
              {{=sesh.field_2012tweetable[0].value}}
            </p>
          {{?}}
          {{? sesh.field_2012sesh_shortdesc[0] }}
            <p class="short">
              {{=sesh.field_2012sesh_shortdesc[0].value}}
            </p>
          {{?}}
          {{? sesh.field_2012sesh_presname[0].value !== null }}
            <div class="presenters">
            <h5>Presenters:</h5>
              {{
              var preses = _.zip( sesh.field_2012sesh_presname, sesh.field_2012sesh_presorg, sesh.field_2012sesh_presbio, sesh.field_2012sesh_prestalk );
              for ( var presesi = 0, presesl = preses.length; presesi < preses.length; presesi++ ) {
              }}
                {{? preses[presesi][0].value.length > 2 }}
                <div>
                  {{? preses[presesi][3] && preses[presesi][3].uid > 0 }}
                  <a href="/user/{{=preses[presesi][3].uid}}">{{?}}{{=preses[presesi][0].value}}{{? preses[presesi][3] && preses[presesi][3].uid > 0 }}</a>{{?}}{{? preses[presesi][1].value.length > 2 }}, {{=preses[presesi][1].value}}{{?}}
                  {{? preses[presesi][2].value.length > 2 }}
                  <div>
                    {{=preses[presesi][2].value}}
                  </div>
                  {{?}}
                </div>
                {{?}}
              {{ } }}
            </div>
          {{?}}
        </div>
        <div class="right">
          <span class="schedblock">
            {{? seshtime !== undefined }}{{=seshtime.get("name")}}{{?}}
          </span>
          <span class="location">
            {{
            var term = app.seshbro.categoriesView.collection.get(sesh.field_2012loc[0].value);
            }}
            {{? term !== undefined }}{{=term.get("name")}}{{?}}
          </span>
          <span class="explev">
            {{
            var term = app.seshbro.categoriesView.collection.get(sesh.field_2012explev[0].value);
            }}
            {{? term !== undefined }}{{=term.get("name")}}{{?}}
          </span> |
          <span class="kid">
            {{
            var term = app.seshbro.categoriesView.collection.get(sesh.field_2012kid[0].value);
            }}
            {{? term !== undefined }}{{=term.get("name")}}{{?}}
          </span> |
          {{? sesh.field_2012hash[0] }}
            <span class="hash">
              #AMC2012 #{{=sesh.field_2012hash[0].value}}
            </span>
          {{?}}
        </div>
        <div class="clear-both">&nbsp;</div>
      </li>
    {{ } }}
  </ul>
</script>

